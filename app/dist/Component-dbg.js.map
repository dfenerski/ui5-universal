{"version":3,"file":"Component-dbg.js","names":["models","_interopRequireDefault","__models","Component","UIComponent","extend","metadata","manifest","interfaces","init","_init","UIComponent.prototype.init.call","setModel","createDeviceModel","createAppModel","getRouter","initialize","SSR_CONTROLS","getRenderer","sap","ui","core","ElementMetadata","prototype","renderer","call","includes","getName","controlClass","getClass","render","onAfterRendering","rm","control","preservedContent","document","querySelector","getId","unsafeHtml","outerHTML","console","error","remove","getContentDensityClass","_getContentDensityClass","contentDensityClass","undefined","body","classList","contains","Device","support","touch"],"sources":["Component.ts"],"sourcesContent":["import Device from 'sap/ui/Device';\nimport Control from 'sap/ui/core/Control';\nimport RenderManager from 'sap/ui/core/RenderManager';\nimport UIComponent from 'sap/ui/core/UIComponent';\nimport models from './model/models';\n\n/**\n * @namespace com.github.dfenerski.ui5_ssr\n */\nexport default class Component extends UIComponent {\n    public static metadata = {\n        manifest: 'json',\n        interfaces: ['sap.ui.core.IAsyncContentCreation'],\n    };\n\n    private contentDensityClass: string;\n\n    public init(): void {\n        // call the base component's init function\n        super.init();\n\n        // create the device model\n        this.setModel(models.createDeviceModel(), 'device');\n\n        // create the app model\n        this.setModel(models.createAppModel(), 'app');\n\n        // create the views based on the url/hash\n        this.getRouter().initialize();\n\n        const SSR_CONTROLS = ['sap.m.Page'];\n        // @ts-expect-error behold\n        const getRenderer = sap.ui.core.ElementMetadata.prototype.getRenderer;\n        // @ts-expect-error behold\n        sap.ui.core.ElementMetadata.prototype.getRenderer = function () {\n            const renderer = getRenderer.call(this);\n            //\n            if (SSR_CONTROLS.includes(this.getName())) {\n                const controlClass = this.getClass();\n                const render = renderer.render;\n                const onAfterRendering =\n                    controlClass.prototype.onAfterRendering;\n                renderer.render = function (\n                    rm: RenderManager,\n                    control: Control,\n                ) {\n                    // const preservedContent = <any>(\n                    //     RenderManager.findPreservedContent(control.getId())\n                    // );\n                    const preservedContent = document.querySelector(\n                        `#sap-ui-ssr #${control.getId()}`,\n                    );\n                    if (preservedContent) {\n                        // preservedContent.remove();\n                        rm.unsafeHtml(preservedContent.outerHTML);\n                        console.error('Preserved content rendered');\n                        return;\n                    }\n                    render.call(renderer, rm, control);\n                };\n                controlClass.prototype.onAfterRendering = function () {\n                    const preservedContent = document.querySelector(\n                        `#sap-ui-ssr #${this.getId()}`,\n                    );\n                    if (preservedContent) {\n                        preservedContent.remove();\n                    }\n                    onAfterRendering.call(this);\n                };\n            }\n            return renderer;\n        };\n    }\n\n    /**\n     * This method can be called to determine whether the sapUiSizeCompact or sapUiSizeCozy\n     * design mode class should be set, which influences the size appearance of some controls.\n     * @public\n     * @returns css class, either 'sapUiSizeCompact' or 'sapUiSizeCozy' - or an empty string if no css class should be set\n     */\n    public getContentDensityClass(): string {\n        if (this.contentDensityClass === undefined) {\n            // check whether FLP has already set the content density class; do nothing in this case\n            if (\n                document.body.classList.contains('sapUiSizeCozy') ||\n                document.body.classList.contains('sapUiSizeCompact')\n            ) {\n                this.contentDensityClass = '';\n            } else if (!Device.support.touch) {\n                // apply \"compact\" mode if touch is not supported\n                this.contentDensityClass = 'sapUiSizeCompact';\n            } else {\n                // \"cozy\" in case of touch support; default for most sap.m controls, but needed for desktop-first controls like sap.ui.table.Table\n                this.contentDensityClass = 'sapUiSizeCozy';\n            }\n        }\n        return this.contentDensityClass;\n    }\n}\n"],"mappings":"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","ignoreList":[]}